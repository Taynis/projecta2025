//©///////////////////////////////////////////////////////////////////////////©//
//
//  Copyright 2021-2025 BIA-Technologies Limited Liability Company
//
//  Licensed under the Apache License, Version 2.0 (the "License");
//  you may not use this file except in compliance with the License.
//  You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
//  Unless required by applicable law or agreed to in writing, software
//  distributed under the License is distributed on an "AS IS" BASIS,
//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//  See the License for the specific language governing permissions and
//  limitations under the License.
//
//©///////////////////////////////////////////////////////////////////////////©//

#Область СлужебныйПрограммныйИнтерфейс

// Проверяет существование метода в указанном модуле. Используется для проверки
// наличия методов в модулях расширения функциональности.
//
// Параметры:
//   ИмяМодуля - Строка - имя модуля для проверки
//   ИмяМетода - Строка - имя метода для проверки
//
// Возвращаемое значение:
//   Булево - Истина, если метод существует в модуле, иначе Ложь
//
// Пример:
//  Если МетодСуществует("РатРасширениеФункциональности", "НовыйМетод") Тогда
//      // Метод существует
//  КонецЕсли;
Функция МетодСуществует(ИмяМодуля, ИмяМетода) Экспорт
	
	Возврат РатРасширениеФункциональностиКлиентСервер.МетодСуществует(ИмяМодуля, ИмяМетода);
	
КонецФункции

// Возвращает имя конфигурации. Используется для получения имени текущей конфигурации
// в контексте расширения функциональности.
//
// Возвращаемое значение:
//   Строка - имя конфигурации
//
// Пример:
//  ИмяКонфиг = ИмяКонфигурации();
//  // Результат: "1С:Предприятие 8"
Функция ИмяКонфигурации() Экспорт
	
	Возврат РатРасширениеФункциональностиВызовСервера.ИмяКонфигурации();
	
КонецФункции

#Если Клиент Тогда
// Возвращает массив модулей клиентских команд. Используется для получения
// списка модулей, содержащих клиентские команды в контексте расширения функциональности.
//
// Возвращаемое значение:
//   Массив из Произвольный - массив модулей клиентских команд
//
// Пример:
//  МодулиКоманд = МодулиКлиентскихКоманд();
//  // Результат: массив модулей с клиентскими командами
Функция МодулиКлиентскихКоманд() Экспорт
	
	Модули = Новый Массив;
	
	Для Каждого ИмяМодуля Из РатРасширениеФункциональностиВызовСервера.ИменаМодулейКлиентскихКоманд() Цикл
		Модули.Добавить(РатАлгоритмы.ВычислитьВыражение(ИмяМодуля));
	КонецЦикла;
	
	Возврат Модули;
	
КонецФункции
#КонецЕсли

#Если Сервер Тогда
// Возвращает массив модулей сервиса. Используется для получения списка модулей,
// содержащих сервисные методы в контексте расширения функциональности.
//
// Возвращаемое значение:
//   Массив из Произвольный - массив модулей сервиса
//
// Пример:
//  МодулиСервисов = МодулиСервиса();
//  // Результат: массив модулей с сервисными методами
Функция МодулиСервиса() Экспорт
	
	Модули = Новый Массив;
	
	Для Каждого ИмяМодуля Из РатРасширениеФункциональностиВызовСервера.ИменаМодулейСервиса() Цикл
		Модули.Добавить(РатАлгоритмы.ВычислитьВыражение(ИмяМодуля));
	КонецЦикла;
	
	Возврат Модули;
	
КонецФункции
#КонецЕсли

// Возвращает имя модуля адаптации конфигурации. Используется для получения
// имени модуля адаптации в зависимости от контекста выполнения (клиент/сервер).
//
// Параметры:
//   ИмяМодуля - Строка - имя модуля для адаптации
//
// Возвращаемое значение:
//   Строка - имя модуля адаптации конфигурации
//
// Пример:
//  ИмяМодуляАдаптации = ИмяМодуляАдаптацииКонфигурации("РатОбщий");
//  // Результат: "РатОбщийКлиент" или "РатОбщийСервер"
Функция ИмяМодуляАдаптацииКонфигурации(ИмяМодуля) Экспорт
	
	НаКлиенте = Ложь;
	НаСервере = Ложь;
#Если Клиент Тогда
	НаКлиенте = Истина;
#КонецЕсли
	
#Если Сервер Тогда
	НаСервере = Истина;
#КонецЕсли
	
	Возврат РатРасширениеФункциональностиВызовСервера.ИмяМодуляАдаптацииКонфигурации(ИмяМодуля, НаКлиенте, НаСервере);
	
КонецФункции

// Возвращает имена модулей адаптации решения. Используется для получения
// списка имен модулей адаптации в зависимости от контекста выполнения (клиент/сервер).
//
// Параметры:
//   ИмяМодуля - Строка - имя модуля для адаптации
//
// Возвращаемое значение:
//   Массив из Строка - массив имен модулей адаптации
//
// Пример:
//  ИменаМодулей = ИменаМодулейАдаптацииРешения("РатОбщий");
//  // Результат: массив имен модулей адаптации
Функция ИменаМодулейАдаптацииРешения(ИмяМодуля) Экспорт
	
	НаКлиенте = Ложь;
	НаСервере = Ложь;
#Если Клиент Тогда
	НаКлиенте = Истина;
#КонецЕсли
	
#Если Сервер Тогда
	НаСервере = Истина;
#КонецЕсли
	
	Возврат РатРасширениеФункциональностиВызовСервера.ИменаМодулейАдаптацииРешения(ИмяМодуля, НаКлиенте, НаСервере);
	
КонецФункции

#КонецОбласти
