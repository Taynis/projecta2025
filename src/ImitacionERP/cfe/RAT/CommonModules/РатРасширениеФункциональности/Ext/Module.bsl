//©///////////////////////////////////////////////////////////////////////////©//
//
//  Copyright 2021-2025 BIA-Technologies Limited Liability Company
//
//  Licensed under the Apache License, Version 2.0 (the "License");
//  you may not use this file except in compliance with the License.
//  You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
//  Unless required by applicable law or agreed to in writing, software
//  distributed under the License is distributed on an "AS IS" BASIS,
//  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//  See the License for the specific language governing permissions and
//  limitations under the License.
//
//©///////////////////////////////////////////////////////////////////////////©//

#Область СлужебныйПрограммныйИнтерфейс

#Область КлиентскиеКоманды

#Если Клиент Тогда
// Возвращает модули клиентских команд для расширения функциональности.
//
// Возвращаемое значение:
//   Массив из Строка - список имен модулей клиентских команд
//
// Пример:
//   Модули = РатРасширениеФункциональности.МодулиКлиентскихКоманд();
//   // Результат: ["РатШагиВанессыКлиент", "РатВызовСервисаКлиент"]
//
Функция МодулиКлиентскихКоманд() Экспорт
	
	Возврат РатРасширениеФункциональностиПовтИсп.МодулиКлиентскихКоманд();
	
КонецФункции
#КонецЕсли

#Если Сервер Тогда
// Возвращает модули сервиса для расширения функциональности.
//
// Возвращаемое значение:
//   Массив из Строка - список имен модулей сервиса
//
// Пример:
//   Модули = РатРасширениеФункциональности.МодулиСервиса();
//   // Результат: ["РатШагиВанессыСервер", "РатСервис"]
//
Функция МодулиСервиса() Экспорт
	
	Возврат РатРасширениеФункциональностиПовтИсп.МодулиСервиса();
	
КонецФункции
#КонецЕсли

#КонецОбласти

#Область АдаптацияКонфигураций

// Вызывает переопределенный метод с указанными параметрами.
//
// Параметры:
//   ИмяМодуля - Строка - имя модуля, в котором находится метод
//   ИмяМетода - Строка - имя вызываемого метода
//   Параметры - Массив из Произвольный - массив параметров для вызова метода
//
// Пример:
//   Параметры = Новый Массив;
//   Параметры.Добавить("ИмяНастройки");
//   РатРасширениеФункциональности.ВызватьМетод("РатШагиВанессыКлиент", "НайтиНастройкиПодключения", Параметры);
//
Процедура ВызватьМетод(ИмяМодуля, ИмяМетода, Параметры) Экспорт
	
	МетодПереопределения = МетодПереопределения(ИмяМодуля, ИмяМетода);
	Если МетодПереопределения <> Неопределено Тогда
		РатАлгоритмы.ВыполнитьМетод(МетодПереопределения, Параметры);
	КонецЕсли;
	
КонецПроцедуры

// Вычисляет значение переопределенного метода с указанными параметрами.
//
// Параметры:
//   ИмяМодуля - Строка - имя модуля, в котором находится метод
//   ИмяМетода - Строка - имя вызываемого метода
//   Параметры - Массив из Произвольный - массив параметров для вызова метода
//
// Возвращаемое значение:
//   Произвольный - результат выполнения метода
//
// Пример:
//   Параметры = Новый Массив;
//   Параметры.Добавить("ИмяНастройки");
//   Настройки = РатРасширениеФункциональности.ВычислитьЗначениеМетода(
//       "РатШагиВанессыКлиент",
//       "НайтиНастройкиПодключения",
//       Параметры);
//
Функция ВычислитьЗначениеМетода(ИмяМодуля, ИмяМетода, Параметры) Экспорт
	
	МетодПереопределения = МетодПереопределения(ИмяМодуля, ИмяМетода);
	Если МетодПереопределения <> Неопределено Тогда
		Возврат РатАлгоритмы.ВызватьФункцию(МетодПереопределения, Параметры);
	КонецЕсли;
	
КонецФункции

// Проверяет наличие переопределения метода.
//
// Параметры:
//   ИмяМодуля - Строка - имя модуля, в котором находится метод
//   ИмяМетода - Строка - имя проверяемого метода
//
// Возвращаемое значение:
//   Булево - Истина, если метод имеет переопределение
//
// Пример:
//   Если РатРасширениеФункциональности.ЕстьПереопределениеМетода("РатШагиВанессыСервер", "ВызватьОбработчик") Тогда
//       // Метод переопределен в адаптации
//   КонецЕсли;
//
Функция ЕстьПереопределениеМетода(ИмяМодуля, ИмяМетода) Экспорт
	
	Возврат МетодПереопределения(ИмяМодуля, ИмяМетода) <> Неопределено;
	
КонецФункции

// Возвращает имя текущей конфигурации.
//
// Возвращаемое значение:
//   Строка - имя конфигурации
//
// Пример:
//   ИмяКонф = РатРасширениеФункциональности.ИмяКонфигурации();
//   // Результат: "Рат"
//
Функция ИмяКонфигурации() Экспорт
	
	Возврат РатРасширениеФункциональностиПовтИсп.ИмяКонфигурации();
	
КонецФункции

#КонецОбласти

// Проверяет существование метода в указанном модуле.
//
// Параметры:
//   ИмяМодуля - Строка - имя проверяемого модуля
//   ИмяМетода - Строка - имя проверяемого метода
//
// Возвращаемое значение:
//   Булево - Истина, если метод существует в модуле
//
// Пример:
//   Если РатРасширениеФункциональности.МетодМодуляСуществует("РатШагиВанессыСервер", "ЗарегистрироватьШаблоны") Тогда
//       // Метод существует и может быть вызван
//   КонецЕсли;
//
Функция МетодМодуляСуществует(ИмяМодуля, ИмяМетода) Экспорт
	
	Возврат РатРасширениеФункциональностиПовтИсп.МетодСуществует(ИмяМодуля, ИмяМетода);
	
КонецФункции

// Проверяет существование метода в указанном объекте.
//
// Параметры:
//   Объект - Произвольный - объект, в котором проверяется метод
//   ИмяМетода - Строка - имя проверяемого метода
//
// Возвращаемое значение:
//   Булево - Истина, если метод существует в объекте
//
// Пример:
//   Модуль = РатШагиВанессыСервер;
//   Если РатРасширениеФункциональности.МетодОбъектаСуществует(Модуль, "ВызватьОбработчик") Тогда
//       // Метод существует в объекте
//   КонецЕсли;
//
Функция МетодОбъектаСуществует(Объект, ИмяМетода) Экспорт
	
	Возврат РатРасширениеФункциональностиКлиентСервер.МетодСуществует("Параметры", ИмяМетода, Объект);
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Возвращает имя модуля адаптации конфигурации для указанного модуля.
//
// Параметры:
//   ИмяМодуля - Строка - имя исходного модуля
//
// Возвращаемое значение:
//   Строка - имя модуля адаптации конфигурации
//
// Пример:
//   ИмяМодуляАдаптации = ИмяМодуляАдаптацииКонфигурации("РатШагиВанессыСервер");
//   // Результат: "РатШагиВанессыСерверАдаптацияКонфигурации"
//
Функция ИмяМодуляАдаптацииКонфигурации(ИмяМодуля)
	
	Возврат РатРасширениеФункциональностиПовтИсп.ИмяМодуляАдаптацииКонфигурации(ИмяМодуля);
	
КонецФункции

// Возвращает имена модулей адаптации решения для указанного модуля.
//
// Параметры:
//   ИмяМодуля - Строка - имя исходного модуля
//
// Возвращаемое значение:
//   Массив из Строка - список имен модулей адаптации решения
//
// Пример:
//   ИменаМодулей = ИменаМодулейАдаптацииРешения("РатШагиВанессыСервер");
//   // Результат: ["РатШагиВанессыСерверАдаптацияРешение"]
//
Функция ИменаМодулейАдаптацииРешения(ИмяМодуля)
	
	Возврат РатРасширениеФункциональностиПовтИсп.ИменаМодулейАдаптацииРешения(ИмяМодуля);
	
КонецФункции

// Определяет переопределение метода в адаптациях конфигурации или решения.
//
// Параметры:
//   ИмяМодуля - Строка - имя исходного модуля
//   ИмяМетода - Строка - имя метода
//
// Возвращаемое значение:
//   Строка - полное имя переопределенного метода
//   Неопределено - если переопределение не найдено
//
// Пример:
//   МетодПереопределения = МетодПереопределения("РатШагиВанессыСервер", "ВызватьОбработчик");
//   // Результат: "РатШагиВанессыСерверАдаптацияКонфигурации.ВызватьОбработчик"
//
Функция МетодПереопределения(ИмяМодуля, ИмяМетода)
	
	МетодПереопределения = МетодАдаптацииКонфигурации(ИмяМодуля, ИмяМетода);
	
	Если МетодПереопределения = Неопределено Тогда
		МетодПереопределения = МетодАдаптацииРешения(ИмяМодуля, ИмяМетода);
	КонецЕсли;
	
	Возврат МетодПереопределения;
	
КонецФункции

// Определяет переопределение метода в адаптации конфигурации.
//
// Параметры:
//   ИмяМодуля - Строка - имя исходного модуля
//   ИмяМетода - Строка - имя метода
//
// Возвращаемое значение:
//   Строка - полное имя переопределенного метода
//   Неопределено - если переопределение не найдено
//
// Пример:
//   МетодАдаптации = МетодАдаптацииКонфигурации("РатШагиВанессыСервер", "ВызватьОбработчик");
//   // Результат: "РатШагиВанессыСерверАдаптацияКонфигурации.ВызватьОбработчик"
//
Функция МетодАдаптацииКонфигурации(ИмяМодуля, ИмяМетода)
	
	ИмяМодуляАдаптации = ИмяМодуляАдаптацииКонфигурации(ИмяМодуля);
	
	Если ИмяМодуляАдаптации <> Неопределено И МетодМодуляСуществует(ИмяМодуляАдаптации, ИмяМетода) Тогда
		Возврат ИмяМодуляАдаптации + "." + ИмяМетода;
	КонецЕсли;
	
	Возврат Неопределено;
	
КонецФункции

// Определяет переопределение метода в адаптации решения.
//
// Параметры:
//   ИмяМодуля - Строка - имя исходного модуля
//   ИмяМетода - Строка - имя метода
//
// Возвращаемое значение:
//   Строка - полное имя переопределенного метода
//   Неопределено - если переопределение не найдено
//
// Пример:
//   МетодАдаптации = МетодАдаптацииРешения("РатШагиВанессыСервер", "ВызватьОбработчик");
//   // Результат: "РатШагиВанессыСерверАдаптацияРешение.ВызватьОбработчик"
//
Функция МетодАдаптацииРешения(ИмяМодуля, ИмяМетода)
	
	ИменаМодулейАдаптации = ИменаМодулейАдаптацииРешения(ИмяМодуля);
	
	Для Каждого ИмяМодуляАдаптации Из ИменаМодулейАдаптации Цикл
		Если МетодМодуляСуществует(ИмяМодуляАдаптации, ИмяМетода) Тогда
			Возврат ИмяМодуляАдаптации + "." + ИмяМетода;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Неопределено;
	
КонецФункции

#КонецОбласти
